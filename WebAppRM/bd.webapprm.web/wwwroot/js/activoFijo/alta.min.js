function eventoMotivoAlta(){$("#IdMotivoAlta").on("change",function(e){partialViewFacturaActivoFijoIsCompra()})}function partialViewFacturaActivoFijoIsCompra(){var e=$("#IdMotivoAlta option:selected").text();e&&""!=e&&null!=e&&-1!=e.toLowerCase().indexOf("compra")?(mostrarLoadingPanel("checkout-form","Cargando detalles de factura..."),$.ajax({url:urlDetalleFacturaAltaActivos,method:"POST",data:{idFacturaActivoFijo:$("#IdFacturaActivoFijo").val()},success:function(e){$("#divOpcionCompra").html(e),Init_DatetimePicker("FacturaActivoFijo_FechaFactura",!0),Init_FileInput("fileFactura")},complete:function(e){$("#checkout-form").waitMe("hide")}})):$("#divOpcionCompra").html("")}function callBackFunctionEliminarDatoEspecifico(e){deleteRowDetallesActivosFijos("tableDetallesActivoFijoSeleccionados",e),eliminarRecepcionActivoFijoDetalleSeleccionado(e),eliminarComponente(e)}function callBackFunctionSeleccionAlta(e,a){var o=$("#hComunesComponentes_"+e).val();if(a){adicionarRecepcionActivoFijoDetalleSeleccionado(e,!0),addComponenteToArray(e,e,o.split(","));var i=$("#tableDetallesActivoFijoAltas"+e+"Sucursal").data("idsucursal"),t='<input type="hidden" id="hComponentes_'+e+'" name="hComponentes_'+e+'" value="'+o+'" />',c='<input type="hidden" class="hiddenIdRecepcionActivoFijoDetalle" id="hIdRecepcionActivoFijoDetalle_'+e+'" name="hIdRecepcionActivoFijoDetalle_'+e+'" value="'+e+'" />',l='<input type="hidden" class="hiddenHEmpleado" id="hEmpleado_'+e+'" name="hEmpleado_'+e+'" value="'+$("#tableDetallesActivoFijoAltas"+e+"Empleado").data("idempleado")+'" />',n='<input type="hidden" id="hSucursal_'+e+'" name="hSucursal_'+e+'" value="'+i+'" />',s='<input type="hidden" id="hUbicacion_'+e+'" name="hUbicacion_'+e+'" value="0" />',r='<a href="javascript:void(0);" onclick="cargarFormularioDatosEmpleado('+e+')" class="btnDatosEmpleado" data-idfila="'+e+'">Custodio</a>',d='<span> | </span><a href="javascript:void(0);" onclick="cargarFormularioComponentesDatosEspecificos('+e+')" class="btnComponentesDatosEspecificos" data-idfila="'+e+'" data-idorigen="'+e+'">Componentes</a>',u="<div id='divEliminarDatosEspecificos_"+e+"' class='btnEliminarDatosEspecificos' style='display:inline;'><span> | </span><a href='javascript: void(0);' id='btnEliminarDatosEspecifico_"+e+"' onclick=abrirVentanaConfirmacion('btnEliminarDatosEspecifico_"+e+"') data-funcioncallback=callBackFunctionEliminarDatoEspecifico('"+e+"') data-titulo='Eliminar' data-descripcion='&#191; Desea eliminar el Activo Fijo seleccionado... ?'>Eliminar</a></div>";addRowDetallesActivosFijos("tableDetallesActivoFijoSeleccionados","tableDetallesActivoFijoAltas",e,[thClassName.numeroRecepcion,thClassName.codigoSecuencial,thClassName.tipoActivoFijo,thClassName.claseActivoFijo,thClassName.subClaseActivoFijo,thClassName.nombreActivoFijo,thClassName.marca,thClassName.modelo,thClassName.serie,thClassName.numeroChasis,thClassName.numeroMotor,thClassName.placa,thClassName.numeroClaveCatastral,thClassName.sucursal,thClassName.dependencia,thClassName.bodega,thClassName.empleado,thClassName.proveedor,thClassName.motivoAlta,thClassName.fechaRecepcion,thClassName.ordenCompra,thClassName.fondoFinanciamiento,t+c+l+n+s+r+d+u],!0)}else callBackFunctionEliminarDatoEspecifico(e)}function cargarFormularioDatosEmpleado(e){var a=$("#hSucursal_"+e).val(),o=$("#hEmpleado_"+e).val();mostrarLoadingPanel("checkout-form","Cargando listados de custodios por sucursal..."),$.ajax({url:urlModalEmpleadosResult,method:"POST",data:{idSucursal:a,idEmpleado:o,idRecepcionActivoFijoDetalle:e},success:function(e){Init_BootBox("Selecci&oacute;n de Custodio",e,null,null,{isGuardar:!0,hideAlGuardar:!1,callbackGuardar:function(){guardarDatosEmpleado()}})},complete:function(e){Init_Select2(),$("#chkTodosEmpleadosDatosEspecificos").prop("checked",""),$("#checkout-form").waitMe("hide")}})}function guardarDatosEmpleado(){mostrarLoadingPanel("divEmpleadoModal","Validando datos, por favor espere...");var t=$("#IdEmpleado").val();if(""!=t&&null!=t){var e=$("#hIdRecepcionActivoFijoDetalleEmpleado").val(),c=$("#hSucursal_"+e).val();if($("#chkTodosEmpleadosDatosEspecificos").prop("checked")){var a=$(".hiddenIdRecepcionActivoFijoDetalle");$.each(a,function(e,a){var o=$(a).val(),i=$("#hSucursal_"+o).val();c==i&&putDatoEmpleadoTable(o,t)})}else putDatoEmpleadoTable(e,t);closeBootBox()}else $("#valIdEmpleado").html("Tiene que seleccionar un Custodio.");$("#divEmpleadoModal").waitMe("hide")}function putDatoEmpleadoTable(e,a){$("#hEmpleado_"+e).val(a),$("#tableDetallesActivoFijoSeleccionados"+e+"Empleado").html($("#IdEmpleado option:selected").text())}function validarDatosEspecificosPertenecenEmpleado(){var e=$(".hiddenHEmpleado"),i=!0;return $.each(e,function(e,a){var o=$(a).val();""!=o.toString()&&null!=o||(i=!1)}),i}function eventoGuardar(){var e=$("#tableDetallesActivoFijoSeleccionados").dataTable().api(),a=$("#checkout-form"),o=!0;0==e.rows().nodes().length&&(mostrarNotificacion("Error","Tiene que seleccionar al menos un Activo Fijo."),o=!1),validarDatosEspecificosPertenecenEmpleado()||(mostrarNotificacion("Error","Tiene que seleccionar el Custodio para todos los Activos Fijos seleccionados."),o=!1),a.valid()||(o=!1),o&&$("#btn-guardar").prop("type","submit")}function cargarFormularioSeleccionNumeroRecepcion(){mostrarLoadingPanel("checkout-form","Cargando recepciones de activos fijos..."),$.ajax({url:urlNumeroRecepcionResult,method:"POST",success:function(e){Init_BootBox("Recepciones de Activos Fijos",'<div class="smart-form" id="divContenedorRecepciones">'+e+'<div class="row" id="divContenedorListadoRecepciones"></div></div>',"large",null),eventoSeleccionNumeroRecepcion()},error:function(e){mostrarNotificacion("Error","Ocurrió un error al cargar las recepciones, inténtelo nuevamente.")},complete:function(e){Init_Select2(),ajustarBootboxPorCiento(80),partialViewListadoActivosFijosParaSeleccion(),$("#checkout-form").waitMe("hide")}})}function eventoSeleccionNumeroRecepcion(){$("#numeroRecepcion").on("change",function(){partialViewListadoActivosFijosParaSeleccion()})}function partialViewListadoActivosFijosParaSeleccion(){mostrarLoadingPanel("divContenedorRecepciones","Cargando recepciones de activos fijos..."),$.ajax({url:urlListadoActivosFijosSeleccionResult,method:"POST",data:{listadoRecepcionActivoFijoDetalleSeleccionado:arrRecepcionActivoFijoDetalleSeleccionado,objAdicional:objAdicional,idRecepcionActivoFijo:$("#numeroRecepcion").val()},success:function(e){$("#divContenedorListadoRecepciones").html(e)},error:function(e){mostrarNotificacion("Error","Ocurrió un error al cargar las recepciones, inténtelo nuevamente.")},complete:function(e){initDataTableFiltrado("tableDetallesActivoFijoAltas",[thClassName.numeroRecepcion,thClassName.bodega,thClassName.proveedor,thClassName.motivoAlta,thClassName.fechaRecepcion,thClassName.ordenCompra,thClassName.fondoFinanciamiento],function(){var e=$("#tableDetallesActivoFijoAltas").dataTable().api(),a=e.rows({page:"current"}).nodes();crearGrupo(e,a,null,[],6,"Descripción de activo fijo",0,24)}),$("#tableDetallesActivoFijoAltas").DataTable().page.len(-1).draw(),tryMarcarCheckBoxTodos(),$("#divContenedorRecepciones").waitMe("hide")}})}funcionEvaluacionSeleccionarTodos=function(){for(var e=0,a=0;a<arrRecepcionActivoFijoDetalleSeleccionado.length;a++){-1!=obtenerPosArrRecepcionActivoFijoDetalleTodos(arrRecepcionActivoFijoDetalleSeleccionado[a].idRecepcionActivoFijoDetalle)&&e++}return e===arrRecepcionActivoFijoDetalleTodos.length},$(document).ready(function(){Init_Select2(),Init_DatetimePicker("FacturaActivoFijo_FechaFactura",!0),Init_DatetimePicker("FechaAlta",!0),Init_DatetimePicker("FechaPago"),eventoMotivoAlta(),inicializarDetallesActivoSeleccion(),inicializarObjetoAdicional(),initDataTableFiltrado("tableDetallesActivoFijoSeleccionados",[thClassName.bodega,thClassName.dependencia,thClassName.proveedor,thClassName.motivoAlta,thClassName.fechaRecepcion,thClassName.ordenCompra,thClassName.fondoFinanciamiento],function(){var e=$("#tableDetallesActivoFijoSeleccionados").dataTable().api(),a=e.rows({page:"current"}).nodes();crearGrupo(e,a,null,[],0,"No. de recepción",0,23)}),Init_FileInput("file"),Init_FileInput("fileFactura"),partialViewFacturaActivoFijoIsCompra(),$("#tableDetallesActivoFijoSeleccionados").DataTable().page.len(-1).draw()});