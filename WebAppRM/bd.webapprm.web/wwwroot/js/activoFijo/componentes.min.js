var arrRecepcionActivoFijoDetalleComponentes=Array(),idFilaDatoEspecificoActual=-1,cantComponentesSeleccionados=0;function initComponentes(){$.each($(".btnComponentesDatosEspecificos"),function(e,o){var t=$(o),n=t.data("idfila");addComponenteToArray(n,t.data("idorigen"),$("#hComponentes_"+n).val().split(","))})}function addComponenteToArray(e,o,t){arrRecepcionActivoFijoDetalleComponentes.push({idFilaDatoEspecifico:e,idRecepcionActivoDetalleOrigen:o,arrIdsComponentes:t})}function cargarFormularioComponentesDatosEspecificos(e){mostrarLoadingPanel("checkout-form","Cargando componentes, por favor espere..."),$("#btnAdicionarComponentes").data("idFila",e),idFilaDatoEspecificoActual=e,$.ajax({url:urlModalComponentesResult,method:"POST",data:{componentesActivo:obtenerRecepcionActivoFijoDetalleComponente(),idsComponentesExcluir:obtenerIdsComponentesExcluir(e)},success:function(e){Init_BootBox("Componentes",'<div id="divContenedorComponentes"><p><button type="button" class="btn btn-primary" style="padding:7px !important;margin-top:7px !important;margin-left:7px !important;" onclick="cargarListadoActivosFijosParaComponentes()" id="btnAdicionarComponentes">Adicionar / Eliminar Componentes</button></p>'+e+"</div>","large",null,null,function(){isComponentes=!1,cantComponentesSeleccionados=0})},error:function(e){mostrarNotificacion("Error","Ocurrió un error al cargar el formulario.")},complete:function(e){initDataTableFiltrado("tableDetallesActivoFijo",[thClassName.bodega,thClassName.proveedor,thClassName.motivoAlta,thClassName.fechaRecepcion,thClassName.ordenCompra,thClassName.fondoFinanciamiento,thClassName.fechaAlta,thClassName.numeroFactura]),$("#tableDetallesActivoFijo_filter > label > span").prop("style","height:32px !important;"),ajustarBootboxPorCiento(80),isComponentes=!0,cantComponentesSeleccionados=0,$("#checkout-form").waitMe("hide")}})}function cargarListadoActivosFijosParaComponentes(){mostrarLoadingPanel("divContenedorComponentes","Cargando listado de activos fijos, por favor espere...");var e=$("#btnAdicionarComponentes").data("idFila"),o=obtenerRecepcionActivoFijoDetalleComponente(),t=obtenerIdsComponentesExcluir(e);t.push(o.idRecepcionActivoDetalleOrigen),$.ajax({url:urlComponentesActivosFijos,method:"POST",data:{componentesActivo:o,idsComponentesExcluir:t},success:function(e){Init_BootBox("Listado de Activos Fijos",e,"large",null,null,function(){isComponentes=!1,cantComponentesSeleccionados=0})},error:function(e){mostrarNotificacion("Error","Ocurrió un error al cargar el formulario.")},complete:function(e){initDataTableFiltrado("tableDetallesActivoFijoComponentes",[thClassName.bodega,thClassName.proveedor,thClassName.motivoAlta,thClassName.fechaRecepcion,thClassName.ordenCompra,thClassName.fondoFinanciamiento,thClassName.fechaAlta,thClassName.numeroFactura]),eventoCheckboxDetallesActivoFijo(),$("#tableDetallesActivoFijoComponentes_filter > label > span").prop("style","height:32px !important;"),ajustarBootboxPorCiento(80),$("#divContenedorComponentes").waitMe("hide")}})}function tryMarcarCheckBoxTodosComponentes(){var e=$("#tableDetallesActivoFijoComponentes").dataTable().api().rows().nodes().length;cantComponentesSeleccionados==e?$("#chkDetalleActivoFijo_0").prop("checked","checked"):$("#chkDetalleActivoFijo_0").prop("checked","")}function obtenerIdsComponentesExcluir(e){for(var o=Array(),t=0;t<arrRecepcionActivoFijoDetalleComponentes.length;t++)if(arrRecepcionActivoFijoDetalleComponentes[t].idFilaDatoEspecifico!=e)for(var n=arrRecepcionActivoFijoDetalleComponentes[t].arrIdsComponentes,a=0;a<n.length;a++)o.push(n[a]);return o}function eliminarIdComponente(e,o){for(var t=0;t<o.arrIdsComponentes.length;t++)if(o.arrIdsComponentes[t]==e)return void o.arrIdsComponentes.splice(t,1)}function eliminarComponente(e){for(var o=0;o<arrRecepcionActivoFijoDetalleComponentes.length;o++)if(arrRecepcionActivoFijoDetalleComponentes[o].idFilaDatoEspecifico==e)return void arrRecepcionActivoFijoDetalleComponentes.splice(o,1)}function obtenerRecepcionActivoFijoDetalleComponente(){for(var e=0;e<arrRecepcionActivoFijoDetalleComponentes.length;e++)if(arrRecepcionActivoFijoDetalleComponentes[e].idFilaDatoEspecifico==idFilaDatoEspecificoActual)return arrRecepcionActivoFijoDetalleComponentes[e];return null}function existeIdComponente(e){for(var o=obtenerRecepcionActivoFijoDetalleComponente(),t=0;t<o.arrIdsComponentes.length;t++)if(o.arrIdsComponentes[t]==e)return!0;return!1}function callBackFunctionSeleccionComponente(e,o){if(o){var t="<div id='divEliminarComponente_"+e+"' class='btnEliminarComponentes' style='display:inline;'><a href='javascript: void(0);' id='btnEliminarComponente_"+e+"' onclick=abrirVentanaConfirmacion('btnEliminarComponente_"+e+"') data-funcioncallback=callBackEliminarComponente('"+e+"') data-titulo='Eliminar' data-descripcion='&#191; Desea eliminar el Componente... ?'>Eliminar</a></div>";addRowDetallesActivosFijos("tableDetallesActivoFijo","tableDetallesActivoFijoComponentes",e,[thClassName.codigoSecuencial,thClassName.tipoActivoFijo,thClassName.claseActivoFijo,thClassName.subClaseActivoFijo,thClassName.nombreActivoFijo,thClassName.marca,thClassName.modelo,thClassName.serie,thClassName.numeroChasis,thClassName.numeroMotor,thClassName.placa,thClassName.numeroClaveCatastral,thClassName.sucursal,thClassName.dependencia,thClassName.bodega,thClassName.empleado,thClassName.proveedor,thClassName.motivoAlta,thClassName.fechaRecepcion,thClassName.ordenCompra,thClassName.fondoFinanciamiento,thClassName.fechaAlta,thClassName.numeroFactura,t],!0),obtenerRecepcionActivoFijoDetalleComponente().arrIdsComponentes.push(e)}else callBackEliminarComponente(e);putValuesComponentesenCampoHidden()}function callBackEliminarComponente(e){deleteRowDetallesActivosFijos("tableDetallesActivoFijo",e),eliminarIdComponente(e,obtenerRecepcionActivoFijoDetalleComponente()),putValuesComponentesenCampoHidden()}function putValuesComponentesenCampoHidden(){var e=$("#hComponentes_"+idFilaDatoEspecificoActual),o=obtenerRecepcionActivoFijoDetalleComponente().arrIdsComponentes.join(",");e.val(o)}jQuery(document).ready(function(){initComponentes()});