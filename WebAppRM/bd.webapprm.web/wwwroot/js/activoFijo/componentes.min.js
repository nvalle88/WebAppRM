var arrRecepcionActivoFijoDetalleComponentes=Array(),idFilaDatoEspecificoActual=-1,isComponentes=!1,cantComponentesSeleccionados=0;function initComponentes(){$.each($(".btnComponentesDatosEspecificos"),function(o,e){var n=$(e),t=n.data("idfila");addComponenteToArray(t,n.data("idorigen"),$("#hComponentes_"+t).val().split(","))})}function addComponenteToArray(o,e,n){arrRecepcionActivoFijoDetalleComponentes.push({idFilaDatoEspecifico:o,idRecepcionActivoDetalleOrigen:e,arrIdsComponentes:n})}function cargarFormularioComponentesDatosEspecificos(o){mostrarLoadingPanel("checkout-form","Cargando componentes, por favor espere..."),$("#btnAdicionarComponentes").data("idFila",o),idFilaDatoEspecificoActual=o,$.ajax({url:urlModalComponentesResult,method:"POST",data:{componentesActivo:obtenerRecepcionActivoFijoDetalleComponente(),idsComponentesExcluir:obtenerIdsComponentesExcluir(o)},success:function(o){Init_BootBox("Componentes",'<div id="divContenedorComponentes"><p><button type="button" class="btn btn-primary" style="padding:7px !important;margin-top:7px !important;margin-left:7px !important;" onclick="cargarListadoActivosFijosParaComponentes()" id="btnAdicionarComponentes">Adicionar / Eliminar Componentes</button></p>'+o+"</div>","large",null,null,function(){isComponentes=!1,cantComponentesSeleccionados=0})},error:function(o){mostrarNotificacion("Error","Ocurrió un error al cargar el formulario.")},complete:function(o){initDataTableFiltrado("tableDetallesActivoFijo",[15,16,17,18,19,20,21]),$("#tableDetallesActivoFijo_filter > label > span").prop("style","height:32px !important;"),ajustarBootboxPorCiento(80),isComponentes=!0,cantComponentesSeleccionados=0,$("#checkout-form").waitMe("hide")}})}function cargarListadoActivosFijosParaComponentes(){mostrarLoadingPanel("divContenedorComponentes","Cargando listado de activos fijos, por favor espere...");var o=$("#btnAdicionarComponentes").data("idFila"),e=obtenerRecepcionActivoFijoDetalleComponente(),n=obtenerIdsComponentesExcluir(o);n.push(e.idRecepcionActivoDetalleOrigen),$.ajax({url:urlComponentesActivosFijos,method:"POST",data:{componentesActivo:e,idsComponentesExcluir:n},success:function(o){Init_BootBox("Listado de Activos Fijos",o,"large",null,null,function(){isComponentes=!1,cantComponentesSeleccionados=0})},error:function(o){mostrarNotificacion("Error","Ocurrió un error al cargar el formulario.")},complete:function(o){initDataTableFiltrado("tableDetallesActivoFijoComponentes",[16,17,18,19,20,21,22]),eventoCheckboxDetallesActivoFijo(),$("#tableDetallesActivoFijoComponentes_filter > label > span").prop("style","height:32px !important;"),ajustarBootboxPorCiento(80),$("#divContenedorComponentes").waitMe("hide")}})}function tryMarcarCheckBoxTodosComponentes(){var o=$("#tableDetallesActivoFijoComponentes").dataTable().api().rows().nodes().length;cantComponentesSeleccionados==o?$("#chkDetalleActivoFijo_0").prop("checked","checked"):$("#chkDetalleActivoFijo_0").prop("checked","")}function obtenerIdsComponentesExcluir(o){for(var e=Array(),n=0;n<arrRecepcionActivoFijoDetalleComponentes.length;n++)if(arrRecepcionActivoFijoDetalleComponentes[n].idFilaDatoEspecifico!=o)for(var t=arrRecepcionActivoFijoDetalleComponentes[n].arrIdsComponentes,i=0;i<t.length;i++)e.push(t[i]);return e}function eliminarIdComponente(o,e){for(var n=0;n<e.arrIdsComponentes.length;n++)if(e.arrIdsComponentes[n]==o)return void e.arrIdsComponentes.splice(n,1)}function eliminarComponente(o){for(var e=0;e<arrRecepcionActivoFijoDetalleComponentes.length;e++)if(arrRecepcionActivoFijoDetalleComponentes[e].idFilaDatoEspecifico==o)return void arrRecepcionActivoFijoDetalleComponentes.splice(e,1)}function obtenerRecepcionActivoFijoDetalleComponente(){for(var o=0;o<arrRecepcionActivoFijoDetalleComponentes.length;o++)if(arrRecepcionActivoFijoDetalleComponentes[o].idFilaDatoEspecifico==idFilaDatoEspecificoActual)return arrRecepcionActivoFijoDetalleComponentes[o];return null}function existeIdComponente(o){for(var e=obtenerRecepcionActivoFijoDetalleComponente(),n=0;n<e.arrIdsComponentes.length;n++)if(e.arrIdsComponentes[n]==o)return!0;return!1}function callBackFunctionSeleccionComponente(o,e){e?(addRowDetallesActivosFijos("tableDetallesActivoFijo","tableDetallesActivoFijoComponentes",o,["Codigosecuencial","TipoActivoFijo","ClaseActivoFijo","SubclaseActivoFijo","NombreActivoFijo","Marca","Modelo","Serie","NumeroChasis","NumeroMotor","Placa","NumeroClaveCatastral","Sucursal","Bodega","Empleado","Proveedor","MotivoAlta","FechaRecepcion","OrdenCompra","FondoFinanciamiento","FechaAlta","NumeroFactura","<div id='divEliminarComponente_"+o+"' class='btnEliminarComponentes' style='display:inline;'><a href='javascript: void(0);' id='btnEliminarComponente_"+o+"' onclick=abrirVentanaConfirmacion('btnEliminarComponente_"+o+"') data-funcioncallback=callBackEliminarComponente('"+o+"') data-titulo='Eliminar' data-descripcion='&#191; Desea eliminar el Componente... ?'>Eliminar</a></div>"],!0),obtenerRecepcionActivoFijoDetalleComponente().arrIdsComponentes.push(o)):callBackEliminarComponente(o);putValuesComponentesenCampoHidden()}function callBackEliminarComponente(o){deleteRowDetallesActivosFijos("tableDetallesActivoFijo",o),eliminarIdComponente(o,obtenerRecepcionActivoFijoDetalleComponente()),putValuesComponentesenCampoHidden()}function putValuesComponentesenCampoHidden(){var o=$("#hComponentes_"+idFilaDatoEspecificoActual),e=obtenerRecepcionActivoFijoDetalleComponente().arrIdsComponentes.join(",");o.val(e)}jQuery(document).ready(function(){initComponentes()});