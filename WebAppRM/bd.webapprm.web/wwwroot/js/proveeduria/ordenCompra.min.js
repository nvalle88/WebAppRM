function eventoCloseModalArticulos(){$("#myModal").on("hidden.bs.modal",function(){$("#modalBodyDatosEspecificos").html("")})}function obtenerIdSucursalObjAdicional(){isAdminNacionalProveeduria&&(objAdicional=$("#Bodega_IdSucursal").val())}function eventoSucursal(){$("#Bodega_IdSucursal").on("change",function(e){obtenerIdSucursalObjAdicional(),partialViewBodega()})}function partialViewBodega(){mostrarLoadingPanel("checkout-form","Cargando bodegas..."),$.ajax({url:bodegaSelectResult,method:"POST",data:{idSucursal:$("#Bodega_IdSucursal").val()},success:function(e){$("#divBodega").html(e),Init_Select2()},complete:function(e){partialViewProveedorEmpleadoDevolucion()}})}function eventoMotivoRecepcionArticulos(){$("#IdMotivoRecepcionArticulos").on("change",function(e){partialViewProveedorEmpleadoDevolucion()})}function partialViewProveedorEmpleadoDevolucion(){"compra"==$("#IdMotivoRecepcionArticulos option:selected").text().toLowerCase()?(mostrarLoadingPanel("checkout-form","Cargando datos de proveedor..."),$.ajax({url:proveedorCompraResult,method:"POST",data:{idOrdenCompra:$("#IdOrdenCompra").val()},success:function(e){mostrarOcultarFieldsetEmpleadoDevolucion(!1),$("#divDetallesProveedor").html(e),mostrarOcultarFieldsetProveedor(!0),partialViewProveedor(),eventoProveedor()},complete:function(e){Init_Select2(),$("#checkout-form").waitMe("hide")}})):(mostrarLoadingPanel("checkout-form","Cargando datos de empleados..."),$.ajax({url:urlEmpleadoDevolucionSelectResult,method:"POST",data:{idSucursal:$("#Bodega_IdSucursal").val()},success:function(e){mostrarOcultarFieldsetProveedor(!1),$("#divDetallesEmpleadoDevolucion").html(e),mostrarOcultarFieldsetEmpleadoDevolucion(!0)},complete:function(e){Init_Select2(),$("#checkout-form").waitMe("hide")}}))}function mostrarOcultarFieldsetProveedor(e){e?($("#legendDetallesProveedor").removeClass("hide"),$("#divDetallesProveedor").removeClass("hide")):($("#legendDetallesProveedor").addClass("hide"),$("#divDetallesProveedor").addClass("hide"),$("#divDetallesProveedor").html(""),$("#divDatosProveedor").html(""))}function mostrarOcultarFieldsetEmpleadoDevolucion(e){e?($("#legendDetallesEmpleadoDevolucion").removeClass("hide"),$("#divDetallesEmpleadoDevolucion").removeClass("hide")):($("#legendDetallesEmpleadoDevolucion").addClass("hide"),$("#divDetallesEmpleadoDevolucion").addClass("hide"),$("#divDetallesEmpleadoDevolucion").html(""))}function eventoSpinner(){$(".spinner").spinner("changed",function(e,o,a){calcularCostos()})}function callBackInicializarTableListadoSeleccion(){initDataTableFiltrado("tableDetallesArticulos",[])}function eventoProveedor(){$("#IdProveedor").on("change",function(e){partialViewProveedor()})}function partialViewProveedor(){"compra"==$("#IdMotivoRecepcionArticulos option:selected").text().toLowerCase()&&(mostrarLoadingPanel("checkout-form","Cargando datos de proveedor..."),$.ajax({url:proveedorSelectResult,method:"POST",data:{idProveedor:$("#IdProveedor").val(),namePartialView:"_ProveedorOrdenCompra"},success:function(e){$("#divDatosProveedor").html(e)},complete:function(e){$("#checkout-form").waitMe("hide")}}))}function callBackFunctionEliminarDatoEspecifico(e){deleteRowDetallesActivosFijos("tableDetallesOrdenCompra",e),eliminarRecepcionActivoFijoDetalleSeleccionado(e),calcularCostos()}function CallbackFunctionCheckBoxArticulo(e,o){o?(adicionarRecepcionActivoFijoDetalleSeleccionado(e,!0),addRowDetallesActivosFijos("tableDetallesOrdenCompra","tableDetallesArticulos",e,["NombreArticulo","UnidadMedida","Cantidad","ValorUnitario","ValorTotal",'<input type="hidden" class="hiddenIdRecepcionActivoFijoDetalle" id="hIdRecepcionActivoFijoDetalle_'+e+'" name="hIdRecepcionActivoFijoDetalle_'+e+'" value="'+e+'" />'+("<div id='divEliminarDatosEspecificos_"+e+"' class='btnEliminarDatosEspecificos' style='display:inline;'><a href='javascript: void(0);' id='btnEliminarDatosEspecifico_"+e+"' onclick=abrirVentanaConfirmacion('btnEliminarDatosEspecifico_"+e+"') data-funcioncallback=callBackFunctionEliminarDatoEspecifico('"+e+"') data-titulo='Eliminar' data-descripcion='&#191; Desea eliminar el Artículo seleccionado... ?'>Eliminar</a></div>")],!0),$("#spinner_"+e).spinner("changed",function(e,o,a){calcularCostos()}),Init_TouchspinPorId("valorUnitario_"+e),$("#valorUnitario_"+e).val("0.00")):callBackFunctionEliminarDatoEspecifico(e)}function calcularCostos(){for(var e=0,o=0;o<arrRecepcionActivoFijoDetalleSeleccionado.length;o++){var a=arrRecepcionActivoFijoDetalleSeleccionado[o].idRecepcionActivoFijoDetalle,i=parseInt($("#cantidad_"+a).val()),t=parseFloat($("#valorUnitario_"+a).val());if(0<i&&0<t){var l=i*t;$("#spanValorTotal_"+a).html("$"+l.toFixed(2)),e+=l}}$("#spanTotal").html(e.toFixed(2))}function eventoGuardar(){$("#btn-guardar").on("click",function(e){var o=$("#tableDetallesOrdenCompra").dataTable().api(),a=$("#checkout-form"),i=!0,t=$("#IdMotivoRecepcionArticulos option:selected").text(),l=$("compra"==t.toLowerCase()?"#IdProveedor":"#IdEmpleadoDevolucion").val(),r="compra"!=t.toLowerCase();if($("#modalBodyDatosEspecificos").html(""),null!=l&&""!=l&&l||(mostrarNotificacion("Error","Tiene que seleccionar un "+(r?"Empleado":"Proveedor")+"."),i=!1),0==o.rows().nodes().length)mostrarNotificacion("Error","Tiene que seleccionar al menos un Artículo."),i=!1;else{$(".touchspin_tasa");var c=!1;$.each($(".touchspin_tasa"),function(e,o){var a=$(o).val().toString();""==a&&$(o).val("0.00"),"0.00"==a&&(c=!0)}),c&&(mostrarNotificacion("Error","Los valores unitarios de los artículos tienen que ser mayor que cero."),i=!1)}if(isAdminZonalProveeduria){var n=$("#IdBodega").val();null!=n&&""!=n||(mostrarNotificacion("Error","Tiene que asignar una Bodega a la dependencia "+$("#IdDependencia").val()+"."),i=!1)}a.valid()||(i=!1),i&&$("#btn-guardar").prop("type","submit")})}$(document).ready(function(){Init_Select2(),Init_DatetimePicker("Fecha",!0,!0),Init_DatetimePicker("Factura_FechaFactura",!0,!0),Init_Touchspin(),eventoProveedor(),partialViewProveedor(),Init_FileInput("file"),inicializarDetallesActivoSeleccion(),initDataTableFiltrado("tableDetallesOrdenCompra",[]),eventoMotivoRecepcionArticulos(),isEditar||partialViewProveedorEmpleadoDevolucion(),eventoSucursal(),eventoGuardar(),eventoSpinner(),calcularCostos(),obtenerIdSucursalObjAdicional(),eventoCloseModalArticulos()});